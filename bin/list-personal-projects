#! /usr/bin/env python3

import os
from pathlib import Path
from typing import Dict, List

ROOT_DIR = os.path.join(
    Path().home(),
    ".local",
    "share",
    "damymetzke",
    "mmp",
    "projects",
    "personal-growth",
)

projects: Dict[str, List[str]] = {
}

def add_to_project(category: str, value: List[str]):
    if category not in projects:
        projects[category] = value
        return

    for item in value:
        projects[category].append(item)

for path in os.listdir(ROOT_DIR):
    if not os.path.isfile:
        continue
    if path[-3:] == ".md":
        with open(os.path.join(ROOT_DIR, path)) as file:
            category = ""
            items: List[str] = []
            for line in file:
                content = line.strip()
                if content[0:2] == "# ":
                    category = " {}".format(content[2:].strip())
                if content[0:6] == "- [ ] ":
                    items.append(" {}".format(content[6:].strip()))
                if content[0:6] == "- [x] ":
                    items.append(" {}".format(content[6:].strip()))
            add_to_project(category, items)
    if path[-9:] == ".list.txt":
        with open(os.path.join(ROOT_DIR, path)) as file:
            items: List[str] = []
            for line in file:
                items.append(line.strip())
            title = path[:-9].replace("-", " ").capitalize()
            add_to_project(" {}".format(title), items)

for category in sorted(projects.keys()):
    print(category.replace("-", " "))

    for project in sorted(projects[category]):
        print("  {}".format(project))

    print()

