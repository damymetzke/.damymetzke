#! /usr/bin/env python3

import os
from pathlib import Path
from typing import Dict, List

ROOT_DIR = os.path.join(
    Path().home(),
    ".local",
    "share",
    "damymetzke",
    "mmp",
    "projects",
    "personal-growth",
)

projects: Dict[str, List[str]] = {
}

def add_to_project(category: str, value: str):
    if category not in projects:
        projects[category] = [value]
        return
    projects[category].append(value)

for path in os.listdir(ROOT_DIR):
    if not os.path.isfile:
        continue
    if path[-3:] == ".md":
        with open(os.path.join(ROOT_DIR, path)) as file:
            for line in file:
                content = line.strip()
                if content[0:2] == "# ":
                    add_to_project("no-category", " {}".format(content[2:].strip()))
                    break
    if path[-9:] == ".list.txt":
        with open(os.path.join(ROOT_DIR, path)) as file:
            for line in file:
                add_to_project(path[:-9], " {}".format(line.strip()))

for category in sorted(projects.keys()):
    print(category.replace("-", " "))

    for project in sorted(projects[category]):
        print("  {}".format(project))

    print()

